# 智慧职教 慕课 自动化

本项目使用了 [Python3](https://www.python.org/)。
以及以下依赖：

- [BeautifulSoup](https://www.crummy.com/software/BeautifulSoup/):

  ```shell
  pip install beautifulsoup4
  ```

## 运行

把 `main.py` 第 12 行的 `Cookie` 修改成自己的，然后执行：

```shell
python3 main.py
```

## 原理

目前摸到了智慧职教以下 API：

### 获取目录

访问以下 URL 并将页面另存为单 HTML 文件作为目录：

```text
https://course.icve.com.cn/learnspace/learn/learn/templateeight/courseware_index.action?params.courseId=6937939f1dfe4af7aef45cc9dcc2459e___
                                                                                                        --------------------------------
                                                                                                        这里改成相应的课程 ID
```

### 通过节点或资源 ID 查询详细信息

访问：

```text
GET https://course.icve.com.cn/learnspace/course/study/learningTime_queryCourseItemInfo.action?itemId=1563079670523367426
                                                                                                      -------------------
                                                                                                      节点或资源 ID
```

返回：

```json
{
  "item": {
    "columnType": "doc",
    "recordType": "0",
    "id": "1563079670523367426",
    "title": "模块1学习导航",
    "courseId": "6937939f1dfe4af7aef45cc9dcc2459e",
    "columnName": "文档"
  },
  "success": "true"
}
```

### 通过节点或资源 ID 查询学习状态

#### 访问

```text
GET https://course.icve.com.cn/learnspace/learn/learnCourseware/getSingleItemCompleteCase.json
Body:
  form-data:
    params.courseId: 6937939f1dfe4af7aef45cc9dcc2459e___
    params.itemId: 1563079670523367426
```

#### 返回

```json
{"result":{"itemId":"1563079670523367426","completed":"1"},"success":true}
```

### 保存学习时长

#### 访问

```text
POST https://course.icve.com.cn/learnspace/course/study/learningTime_saveCourseItemLearnRecord.action
Header:
  Cookie: <YOUR COOKIE>
  Body:
    courseId: 6937939f1dfe4af7aef45cc9dcc2459e
    studyTime: 300
    itemId: 1563079672993812481
```

#### 返回

```json
{"success":"true","errorCode":"1","errorMsg":"成功!"}
```

### 保存视频学习时长

> 这个视频学习时常摸了半天没摸出来 Body 里两个值是哪儿来的
> `studyRecord` 也搞不清是什么编码（反正不是 base64
> Orz 懒得搞了（下次一定

#### 访问

```text
POST https://course.icve.com.cn/learnspace/course/study/learningTime_saveVideoLearnDetailRecord.action
Header:
  Cookie: <YOUR COOKIE>
  Body:
    studyRecord: RqyVqH93zLKwqQSt3KhJ3vDWL7t7uX3bjLKidA0j8y53WCz29lHmg/zzMksoNB5Ye2AKvtsmGPUVDQfElmInpBJL42ST6gI9bsIwyKaJw+gRCWmucddqBHZcvfw7bYb+LLEoxtX3drzCfbki5tHddAtVQU9rSFLa8hlPzUfJvLtJYCut+W0w1h0F34fxrXx77z/InxB3302OtW1oZhj9VUPFV82rIgRAzbpnOXw+WtyZDP7HoJj2Rjob4lPC0EN8asNtqIuPrh7JNFxumXjPG1L6ttRr6DQ3dTPa7jIFeMeSsHe9+HT8iAeVsqK796Piarq/9WUHpRx94LANQM3MuqkBYFX1zMNQcGwoskopED0=
    limitId: e972d8db916a4d7db6f312bf819670fd
```

#### 返回

```json
{
  "data": {
    "timeRecordResult": {
      "msg": "保存视频节点学习时长 和 节点完成状态成功！",
      "success": "true"
    }
  },
  "success": "true",
  "info": "保存成功"
}
```